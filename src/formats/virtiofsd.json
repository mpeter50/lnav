{
    "$schema": "https://lnav.org/schemas/format-v1.schema.json",
    "virtiofsd_log": {
        "title": "VirtIO-FS Daemon",
        "description": "The VirtIO-FS Daemon's log format",
        "url": "https://virtio-fs.gitlab.io/",
        "regex": {
            "file_log": {
                "pattern": "^\\[(?<timestamp>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z) (?<level>\\w+) \\s*(?<component>[^\\]]+)\\] (?<body>.*)$"
            },
            "syslog": {
                "pattern": "TODO",
                "module-format": true
            }
        },
        "level-field": "level",
        "value": {
            "component": {
                "kind": "string",
                "identifier": true
            }
        },
        "highlights": {
            "operation": {
                "pattern": "opcode=\\w+ \\(\\d+\\)"
            },
            "inode": {
                "pattern": "inode=\\d+"
            },
            "pid": {
                "pattern": "pid=\\d+"
            }
        },
        "sample": [
            {
                "line": "[2024-07-20T14:21:23Z INFO  virtiofsd] Waiting for vhost-user socket connection...",
                "level": "info"
            },
            {
                "line": "[2024-07-20T14:21:58Z DEBUG virtiofsd::server] Received request: opcode=Lookup (1), inode=1111, unique=2222, pid=3333",
                "level": "debug"
                // ')' at the end of opcode gets dropped by field recognition, but highlights highlight it as expected
            }
        ]
    }
}
